Public Function IP2BIN(IPaddress As String) As String
'
' Excel VBA function returning a string with a binary version of an IPv4 valid IP address
' This function must be saved in a module of Excel and not in a sheet in order to be able to use it from a workbook
' As it uses the function isIPv4(), you need to copy this function too.
' Created on August 2016
' Author: Emmanuel Nicaise for Apalala sprl
'
' Version 1.0
' Last updated on 26 of August 2016
'
Dim Octet() As String
Dim x, n, temp As Integer
Dim BIN As String


If isIPv4(IPaddress) Then
' if the parameter IPaddress is a valid IP address continue the analysis
     
     Octet = Split(IPaddress, ".")
     BIN = ""
     For x = 3 To 0 Step -1
     temp = Val(Octet(x))
        For n = 1 To 8
            BIN = temp Mod 2 & BIN
            temp = temp \ 2
        Next
    Next
    IP2BIN = BIN
Else:
    IP2BIN = "Not a valid IPv4 address"
End If
     
End Function
