Public Function getIP(Host As String) As String
    ' getIP() function for Microsoft Excel under Windows
    ' Copyright Apalala sprl (2015)
    ' Author: Emmanuel Nicaise
    ' Version: 1.0 (last updated: 30/09/2015)
    '
    'Run a nslookup in shell command, returning the output as a string
    Dim oShell As Object
    Set oShell = CreateObject("WScript.Shell")
    ' run command
    Dim oExec As Object
    Dim oOutput As Object
    ' call nslookup executable with the hostname in parameter
    Set oExec = oShell.exec("nslookup " & Host)
    Set oOutput = oExec.StdOut
    ' handle the results as they are written to and read from the StdOut object
    Dim s(10) As String
    Dim IP As String
    Dim line As Integer
    line = 1
    'store result in a array, one line per item
    While Not oOutput.AtEndOfStream
        s(line) = oOutput.ReadLine
        line = line + 1
    Wend

    'IP value start at the 11th character of the 5th line of the standard output from nslookup
    IP = Mid(s(5), 11, Len(s(5)) - 10)
    ' Return the IP as function result
    getIP = IP
End Function
